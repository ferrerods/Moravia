@model List<ChessProject.Models.Square>
@{
    ViewData["Title"] = "Chess";
}

<h1>Chess</h1>
<h4>Are you ready to play?</h4>
<fom id="formChess" method="post">
    <input type="button" id="newGame" value="Go!" />
</fom>

<p></p>
<fom id="formInsertPiece" method="post">
    <label>
        Enter the coordinates of the chess piece selected:
    </label>
    <input type="text" id="pieceSelected" class="input-group-text" />
    <label>
        Enter the coordinates of the new position:
    </label>
    <input type="text" id="positionSelected" class="input-group-text" />
</fom>

    <div class="board">
        <table class="table">
            <thead>
                <tr>
                    <th scope="col"></th>
                    <th scope="col">a</th>
                    <th scope="col">b</th>
                    <th scope="col">c</th>
                    <th scope="col">d</th>
                    <th scope="col">e</th>
                    <th scope="col">f</th>
                    <th scope="col">g</th>
                    <th scope="col">h</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <th>8</th>
                    <td id="8a" class="square">@ViewBag.Square[63].ImgPiece</td>
                    <td id="8b" class="squareDark">@ViewBag.Square[62].ImgPiece</td>
                    <td id="8c" class="square">@ViewBag.Square[61].ImgPiece</td>
                    <td id="8d" class="squareDark">@ViewBag.Square[60].ImgPiece</td>
                    <td id="8e" class="square">@ViewBag.Square[59].ImgPiece</td>
                    <td id="8f" class="squareDark">@ViewBag.Square[58].ImgPiece</td>
                    <td id="8g" class="square">@ViewBag.Square[57].ImgPiece</td>
                    <td id="8h" class="squareDark">@ViewBag.Square[56].ImgPiece</td>
                </tr>
                <tr>
                    <th>7</th>
                    <td id="7a" class="squareDark">@ViewBag.Square[55].ImgPiece</td>
                    <td id="7b" class="square">@ViewBag.Square[54].ImgPiece</td>
                    <td id="7c" class="squareDark">@ViewBag.Square[53].ImgPiece</td>
                    <td id="7d" class="square">@ViewBag.Square[52].ImgPiece</td>
                    <td id="7e" class="squareDark">@ViewBag.Square[51].ImgPiece</td>
                    <td id="7f" class="square">@ViewBag.Square[50].ImgPiece</td>
                    <td id="7g" class="squareDark">@ViewBag.Square[49].ImgPiece</td>
                    <td id="7h" class="square">@ViewBag.Square[48].ImgPiece</td>
                </tr>
                <tr>
                    <th>6</th>
                    <td id="6a" class="square">@ViewBag.Square[47].ImgPiece</td>
                    <td id="6b" class="squareDark">@ViewBag.Square[46].ImgPiece</td>
                    <td id="6c" class="square">@ViewBag.Square[45].ImgPiece</td>
                    <td id="6d" class="squareDark">@ViewBag.Square[44].ImgPiece</td>
                    <td id="6e" class="square">@ViewBag.Square[43].ImgPiece</td>
                    <td id="6f" class="squareDark">@ViewBag.Square[42].ImgPiece</td>
                    <td id="6g" class="square">@ViewBag.Square[41].ImgPiece</td>
                    <td id="6h" class="squareDark">@ViewBag.Square[40].ImgPiece</td>
                </tr>
                <tr>
                    <th>5</th>
                    <td id="5a" class="squareDark">@ViewBag.Square[39].ImgPiece</td>
                    <td id="5b" class="square">@ViewBag.Square[38].ImgPiece</td>
                    <td id="5c" class="squareDark">@ViewBag.Square[37].ImgPiece</td>
                    <td id="5d" class="square">@ViewBag.Square[36].ImgPiece</td>
                    <td id="5e" class="squareDark">@ViewBag.Square[35].ImgPiece</td>
                    <td id="5f" class="square">@ViewBag.Square[34].ImgPiece</td>
                    <td id="5g" class="squareDark">@ViewBag.Square[33].ImgPiece</td>
                    <td id="5h" class="square">@ViewBag.Square[32].ImgPiece</td>
                </tr>
                <tr>
                    <th>4</th>
                    <td id="4a" class="square">@ViewBag.Square[31].ImgPiece</td>
                    <td id="4b" class="squareDark">@ViewBag.Square[30].ImgPiece</td>
                    <td id="4c" class="square">@ViewBag.Square[29].ImgPiece</td>
                    <td id="4d" class="squareDark">@ViewBag.Square[28].ImgPiece</td>
                    <td id="4e" class="square">@ViewBag.Square[27].ImgPiece</td>
                    <td id="4f" class="squareDark">@ViewBag.Square[26].ImgPiece</td>
                    <td id="4g" class="square">@ViewBag.Square[25].ImgPiece</td>
                    <td id="4h" class="squareDark">@ViewBag.Square[24].ImgPiece</td>
                </tr>
                <tr>
                    <th>3</th>
                    <td id="3a" class="squareDark">@ViewBag.Square[23].ImgPiece</td>
                    <td id="3b" class="square">@ViewBag.Square[22].ImgPiece</td>
                    <td id="3c" class="squareDark">@ViewBag.Square[21].ImgPiece</td>
                    <td id="3d" class="square">@ViewBag.Square[20].ImgPiece</td>
                    <td id="3e" class="squareDark">@ViewBag.Square[19].ImgPiece</td>
                    <td id="3f" class="square">@ViewBag.Square[18].ImgPiece</td>
                    <td id="3g" class="squareDark">@ViewBag.Square[17].ImgPiece</td>
                    <td id="3h" class="square">@ViewBag.Square[16].ImgPiece</td>
                </tr>
                <tr>
                    <th>2</th>
                    <td id="2a" class="square">@ViewBag.Square[15].ImgPiece</td>
                    <td id="2b" class="squareDark">@ViewBag.Square[14].ImgPiece</td>
                    <td id="2c" class="square">@ViewBag.Square[13].ImgPiece</td>
                    <td id="2d" class="squareDark">@ViewBag.Square[12].ImgPiece</td>
                    <td id="2e" class="square">@ViewBag.Square[11].ImgPiece</td>
                    <td id="2f" class="squareDark">@ViewBag.Square[10].ImgPiece</td>
                    <td id="2g" class="square">@ViewBag.Square[9].ImgPiece</td>
                    <td id="2h" class="squareDark">@ViewBag.Square[8].ImgPiece</td>
                </tr>
                <tr>
                    <th>1</th>
                    <td id="1a" class="squareDark">@ViewBag.Square[7].ImgPiece</td>
                    <td id="1b" class="square">@ViewBag.Square[6].ImgPiece</td>
                    <td id="1c" class="squareDark">@ViewBag.Square[5].ImgPiece</td>
                    <td id="1d" class="square">@ViewBag.Square[4].ImgPiece</td>
                    <td id="1e" class="squareDark">@ViewBag.Square[3].ImgPiece</td>
                    <td id="1f" class="square">@ViewBag.Square[2].ImgPiece</td>
                    <td id="1g" class="squareDark">@ViewBag.Square[1].ImgPiece</td>
                    <td id="1h" class="square">@ViewBag.Square[0].ImgPiece</td>
                </tr>
            </tbody>
        </table>
    </div>


    @section scripts {
        <script type="text/javascript">
        $(document).ready(function () {

            $("#pieceSelected").prop('disabled', true);
            $("#positionSelected").prop('disabled', true);

            $("#newGame").click(function (event) {
                //$(".board .table tbody td").empty();
                location.href = '@Url.Action("NewGame", "Chess")';
            });

            if ('@TempData["mensaje"]' == "redirect") {
                //$(".board .table tbody td").empty();

                $("#pieceSelected").prop('disabled', false);
                $("#positionSelected").prop('disabled', false);

                //LoadPiece();
            }

            $("#pieceSelected").change(function () {
                Validate();
            });

            function Validate() {
                var varEntry = $("#pieceSelected").val();

                var idSquare = ConvertId(varEntry);
               
                //busco en tabla
                var square = idSquare;
                var squareVar = $(square).val();

                if (squareVar == null)
                { alert("Empty square"); }
                else {

                    switch (squareVar) {
                        case "♟": alert(peon); //pawn black
                        case "♙": alert(peon); //pawn white

                        case "♞": alert(tower); //tower black
                        case "♘": alert(tower); //tower white

                        case "♝": alert(bishop); //bishop black
                        case "♗": alert(bishop); //bishop white
                    }
                }
            }

            function ConvertId(varEntry) {

                var letters = ["a", "b", "c", "d", "e", "f", "g", "h"];
                var newArray = [];
                var idSquare = Array.from(varEntry);

                if (idSquare.length > 2 || idSquare.length < 2) {
                        alert("Insert row-column"); 
                }

                $.each(idSquare, function (index, value) {
                    if ($.isNumeric(value)) {

                        if (value < 1 || value > 8) {
                            alert("Insert values ​​from 1 to 8");
                        }
                        else {
                            newArray.push("#");
                            newArray.push(Value);
                            newArray.push(idSquare[index + 1]);
                        } 

                    }
                    else {
                        if (!letters.include(value)) {
                            alert("Insert values ​​from a to h");
                        }
                        else{
                            newArray.push("#");
                            newArray.push(idSquare[index + 1]);
                            newArray.push(Value);
                        }

                    }

                    alert(newArray.toString());
                });

                return newArray.toString();
            }

        });
        </script>
    }